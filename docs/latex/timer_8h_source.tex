\doxysection{timer.\+h}
\hypertarget{timer_8h_source}{}\label{timer_8h_source}\index{include/core/cortex-\/m4/timer.h@{include/core/cortex-\/m4/timer.h}}
\mbox{\hyperlink{timer_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{preprocessor}{\#ifndef\ CORTEX\_M4\_TIMER\_H}}
\DoxyCodeLine{00002\ \textcolor{preprocessor}{\#define\ CORTEX\_M4\_TIMER\_H}}
\DoxyCodeLine{00003\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{types_8h}{utils/types.h}}"{}}}
\DoxyCodeLine{00004\ }
\DoxyCodeLine{00005\ \textcolor{preprocessor}{\#define\ RCC\_BASE\ 0x40023800}}
\DoxyCodeLine{00006\ }
\DoxyCodeLine{00007\ \textcolor{preprocessor}{\#define\ RCC\_APB1ENR\ (*(volatile\ uint32\_t\ *)(RCC\_BASE\ +\ 0x40))}}
\DoxyCodeLine{00008\ \textcolor{preprocessor}{\#define\ RCC\_APB1ENR\_TIM2\_OFFSET\ 0}}
\DoxyCodeLine{00009\ \textcolor{preprocessor}{\#define\ RCC\_APB1ENR\_TIM3\_OFFSET\ 1}}
\DoxyCodeLine{00010\ \textcolor{preprocessor}{\#define\ RCC\_APB1ENR\_TIM4\_OFFSET\ 2}}
\DoxyCodeLine{00011\ \textcolor{preprocessor}{\#define\ RCC\_APB1ENR\_TIM5\_OFFSET\ 3}}
\DoxyCodeLine{00012\ }
\DoxyCodeLine{00013\ \textcolor{preprocessor}{\#define\ RCC\_APB2ENR\ (*(volatile\ uint32\_t\ *)(RCC\_BASE\ +\ 0x44))}}
\DoxyCodeLine{00014\ \textcolor{preprocessor}{\#define\ RCC\_APB2ENR\_TIM1\_OFFSET\ 0}}
\DoxyCodeLine{00015\ \textcolor{preprocessor}{\#define\ RCC\_APB2ENR\_TIM9\_OFFSET\ 16}}
\DoxyCodeLine{00016\ \textcolor{preprocessor}{\#define\ RCC\_APB2ENR\_TIM10\_OFFSET\ 17}}
\DoxyCodeLine{00017\ \textcolor{preprocessor}{\#define\ RCC\_APB2ENR\_TIM11\_OFFSET\ 18}}
\DoxyCodeLine{00018\ }
\DoxyCodeLine{00019\ \textcolor{preprocessor}{\#define\ TIM1\_BASE\ 0x40010000}}
\DoxyCodeLine{00020\ \textcolor{preprocessor}{\#define\ TIM2\_BASE\ 0x40000000}}
\DoxyCodeLine{00021\ \textcolor{preprocessor}{\#define\ TIM3\_BASE\ 0x40000400}}
\DoxyCodeLine{00022\ \textcolor{preprocessor}{\#define\ TIM4\_BASE\ 0x40000800}}
\DoxyCodeLine{00023\ \textcolor{preprocessor}{\#define\ TIM5\_BASE\ 0x40000C00}}
\DoxyCodeLine{00024\ \textcolor{preprocessor}{\#define\ TIM9\_BASE\ 0x40014000}}
\DoxyCodeLine{00025\ \textcolor{preprocessor}{\#define\ TIM10\_BASE\ 0x40014400}}
\DoxyCodeLine{00026\ \textcolor{preprocessor}{\#define\ TIM11\_BASE\ 0x40014800}}
\DoxyCodeLine{00027\ }
\DoxyCodeLine{00028\ \textcolor{comment}{//\ Advance\ Timer\ 1}}
\DoxyCodeLine{00029\ \textcolor{comment}{//\ Labled\ as\ ADV}}
\DoxyCodeLine{00030\ \textcolor{preprocessor}{\#define\ TIM\_ADV\_CR1\_OFFSET\ 0x00}}
\DoxyCodeLine{00031\ \textcolor{preprocessor}{\#define\ TIM\_ADV\_CR1\_CEN\_BIT\ 0x00}}
\DoxyCodeLine{00032\ \textcolor{preprocessor}{\#define\ TIM\_ADV\_PSC\_OFFSET\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00033\ \textcolor{preprocessor}{\ \ 0x28\ }\textcolor{comment}{//\ Timer\ tick\ =\ ABP1\_CLK/(prescaler+1),\ Use\ only\ lower\ 16\ bits,\ upper}}
\DoxyCodeLine{00034\ \ \ \ \ \ \ \ \textcolor{comment}{//\ bits\ are\ reserved}}
\DoxyCodeLine{00035\ \textcolor{preprocessor}{\#define\ TIM\_ADV\_ARR\_OFFSET\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00036\ \textcolor{preprocessor}{\ \ 0x2C\ }\textcolor{comment}{//\ Upper\ 16\ bits\ are\ only\ available\ for\ TIM2\ and\ TIM5,\ reserved\ for\ rest}}
\DoxyCodeLine{00037\ \textcolor{preprocessor}{\#define\ TIM\_ADV\_EGR\_OFFSET\ 0x14\ }\textcolor{comment}{//\ Event\ generator}}
\DoxyCodeLine{00038\ \textcolor{preprocessor}{\#define\ TIM\_ADV\_EGR\_UG\_BIT\ 0x00\ }\textcolor{comment}{//\ Reinitialize\ the\ timer}}
\DoxyCodeLine{00039\ \textcolor{preprocessor}{\#define\ TIM\_ADV\_CNT\_OFFSET\ 0X24}}
\DoxyCodeLine{00040\ }
\DoxyCodeLine{00041\ \textcolor{comment}{//\ GP\ Timer\ 2-\/5\ on\ APB1}}
\DoxyCodeLine{00042\ \textcolor{comment}{//\ Labled\ as\ GP1}}
\DoxyCodeLine{00043\ \textcolor{preprocessor}{\#define\ TIM\_GP1\_CR1\_OFFSET\ 0x00}}
\DoxyCodeLine{00044\ \textcolor{preprocessor}{\#define\ TIM\_GP1\_CR1\_CEN\_BIT\ 0x00}}
\DoxyCodeLine{00045\ \textcolor{preprocessor}{\#define\ TIM\_GP1\_PSC\_OFFSET\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00046\ \textcolor{preprocessor}{\ \ 0x28\ }\textcolor{comment}{//\ Timer\ tick\ =\ ABP1\_CLK/(prescaler+1),\ Use\ only\ lower\ 16\ bits,\ upper}}
\DoxyCodeLine{00047\ \ \ \ \ \ \ \ \textcolor{comment}{//\ bits\ are\ reserved}}
\DoxyCodeLine{00048\ \textcolor{preprocessor}{\#define\ TIM\_GP1\_ARR\_OFFSET\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00049\ \textcolor{preprocessor}{\ \ 0x2C\ }\textcolor{comment}{//\ Upper\ 16\ bits\ are\ only\ available\ for\ TIM2\ and\ TIM5,\ reserved\ for\ rest}}
\DoxyCodeLine{00050\ \textcolor{preprocessor}{\#define\ TIM\_GP1\_EGR\_OFFSET\ 0x14\ }\textcolor{comment}{//\ Event\ generator}}
\DoxyCodeLine{00051\ \textcolor{preprocessor}{\#define\ TIM\_GP1\_EGR\_UG\_BIT\ 0x00\ }\textcolor{comment}{//\ Reinitialize\ the\ timer}}
\DoxyCodeLine{00052\ \textcolor{preprocessor}{\#define\ TIM\_GP1\_CNT\_OFFSET\ 0X24}}
\DoxyCodeLine{00053\ }
\DoxyCodeLine{00054\ \textcolor{comment}{//\ GP\ Timer\ 9-\/11\ on\ APB1}}
\DoxyCodeLine{00055\ \textcolor{comment}{//\ Labled\ as\ GP2}}
\DoxyCodeLine{00056\ \textcolor{preprocessor}{\#define\ TIM\_GP2\_CR1\_OFFSET\ 0x00}}
\DoxyCodeLine{00057\ \textcolor{preprocessor}{\#define\ TIM\_GP2\_CR1\_CEN\_BIT\ 0x00}}
\DoxyCodeLine{00058\ \textcolor{preprocessor}{\#define\ TIM\_GP2\_PSC\_OFFSET\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00059\ \textcolor{preprocessor}{\ \ 0x28\ }\textcolor{comment}{//\ Timer\ tick\ =\ ABP2\_CLK/(prescaler+1),\ Use\ only\ lower\ 16\ bits,\ upper}}
\DoxyCodeLine{00060\ \ \ \ \ \ \ \ \textcolor{comment}{//\ bits\ are\ reserved}}
\DoxyCodeLine{00061\ \textcolor{preprocessor}{\#define\ TIM\_GP2\_ARR\_OFFSET\ 0x2C\ }\textcolor{comment}{//\ only\ lower\ 16\ bits\ availabnle}}
\DoxyCodeLine{00062\ \textcolor{preprocessor}{\#define\ TIM\_GP2\_EGR\_OFFSET\ 0x14\ }\textcolor{comment}{//\ Event\ generator}}
\DoxyCodeLine{00063\ \textcolor{preprocessor}{\#define\ TIM\_GP2\_EGR\_UG\_BIT\ 0x0\ \ }\textcolor{comment}{//\ Reinitialize\ the\ timer}}
\DoxyCodeLine{00064\ \textcolor{preprocessor}{\#define\ TIM\_GP2\_CNT\_OFFSET\ 0X24}}
\DoxyCodeLine{00065\ }
\DoxyCodeLine{00066\ \textcolor{comment}{//\ SysTick\ Control\ and\ Status\ Register}}
\DoxyCodeLine{00067\ \textcolor{preprocessor}{\#define\ SYST\_CSR\ (*(volatile\ uint32\_t\ *)0xE000E010)}}
\DoxyCodeLine{00068\ \textcolor{comment}{//\ SysTick\ Reload\ Value\ Register}}
\DoxyCodeLine{00069\ \textcolor{preprocessor}{\#define\ SYST\_RVR\ (*(volatile\ uint32\_t\ *)0xE000E014)}}
\DoxyCodeLine{00070\ \textcolor{comment}{//\ SysTick\ Current\ Value\ Register}}
\DoxyCodeLine{00071\ \textcolor{preprocessor}{\#define\ SYST\_CVR\ (*(volatile\ uint32\_t\ *)0xE000E018)}}
\DoxyCodeLine{00072\ \textcolor{comment}{//\ SysTick\ Calibration\ Register}}
\DoxyCodeLine{00073\ \textcolor{preprocessor}{\#define\ SYST\_CALIB\ (*(volatile\ uint32\_t\ *)0xE000E01C)}}
\DoxyCodeLine{00074\ \textcolor{preprocessor}{\#define\ SYST\_CSR\_EN\_BIT\ 0}}
\DoxyCodeLine{00075\ \textcolor{preprocessor}{\#define\ SYST\_CSR\_TICKINT\_BIT\ 1}}
\DoxyCodeLine{00076\ \textcolor{preprocessor}{\#define\ SYST\_CSR\_CLKSOURCE\_BIT\ 2}}
\DoxyCodeLine{00077\ \textcolor{comment}{//\ SysTick\ Timer\ Functions}}
\DoxyCodeLine{00078\ \textcolor{comment}{//\ TIM5\ is\ used\ for\ systick}}
\DoxyCodeLine{00079\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{timer_8h_a51591e1b5e966fd8031bed4ff27ba3b7}{systick\_init}}(uint32\_t\ tick\_us);}
\DoxyCodeLine{00080\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{timer_8h_ab7cce8122024d7ba47bf10f434956de4}{delay\_ms}}(uint32\_t\ ms);}
\DoxyCodeLine{00081\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{timer_8h_a025aed4c2e0c624b412158b404806a2a}{delay\_us}}(uint64\_t\ us);}
\DoxyCodeLine{00082\ uint64\_t\ \mbox{\hyperlink{timer_8h_a8aea94afb2c6534c316c01aca84dacb3}{hal\_get\_tick}}(\textcolor{keywordtype}{void});}
\DoxyCodeLine{00083\ uint32\_t\ \mbox{\hyperlink{timer_8h_abb6898e3bf58a48224867791dbdefdf3}{hal\_get\_tick\_duration\_us}}(\textcolor{keywordtype}{void});}
\DoxyCodeLine{00084\ uint32\_t\ \mbox{\hyperlink{timer_8h_a3dafc6a0248d43b6a4c076b7dbcfc23f}{hal\_get\_tick\_reload\_value}}(\textcolor{keywordtype}{void});}
\DoxyCodeLine{00085\ uint32\_t\ \mbox{\hyperlink{timer_8h_a71ab66b2798cd4aafcfe0a24b9154594}{hal\_get\_millis}}(\textcolor{keywordtype}{void});}
\DoxyCodeLine{00086\ uint32\_t\ \mbox{\hyperlink{timer_8h_ade6c3437a366ce7aaf9617e69a848df9}{hal\_get\_micros}}(\textcolor{keywordtype}{void});}
\DoxyCodeLine{00087\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{timer_8h_ab5e09814056d617c521549e542639b7e}{SysTick\_Handler}}(\textcolor{keywordtype}{void});\ \textcolor{comment}{//\ ISR\ for\ systick\ interrupts}}
\DoxyCodeLine{00088\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{timer_8h_abd90df18c8f6730a6ba675cf639247a4}{hal\_systick\_set\_callback}}(\textcolor{keywordtype}{void}\ (*cb)(\textcolor{keywordtype}{void}));}
\DoxyCodeLine{00089\ }
\DoxyCodeLine{00090\ \textcolor{comment}{//\ General\ Purpose\ Timer\ (TIMx)\ Initialization\ \&\ Control}}
\DoxyCodeLine{00091\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{timer_8h_adfbc1cc33f34b935f0b0ee61d2d3f6f8}{timer\_init}}(\mbox{\hyperlink{timer__types_8h_a8bcc65cef9829505cbc2b3512bc017db}{hal\_timer\_t}}\ timer,\ uint32\_t\ prescaler,\ uint32\_t\ auto\_reload);}
\DoxyCodeLine{00092\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{timer_8h_a49fb0f6c6b9a4802601a452618672e52}{timer\_start}}(\mbox{\hyperlink{timer__types_8h_a8bcc65cef9829505cbc2b3512bc017db}{hal\_timer\_t}}\ timer);}
\DoxyCodeLine{00093\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{timer_8h_a196e32e61e4a4d6cb50e46ebffb1e0b8}{timer\_stop}}(\mbox{\hyperlink{timer__types_8h_a8bcc65cef9829505cbc2b3512bc017db}{hal\_timer\_t}}\ timer);}
\DoxyCodeLine{00094\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{timer_8h_ab50e7d8e6b8713a9a96abc6dd3a9e932}{timer\_reset}}(\mbox{\hyperlink{timer__types_8h_a8bcc65cef9829505cbc2b3512bc017db}{hal\_timer\_t}}\ timer);}
\DoxyCodeLine{00095\ uint32\_t\ \mbox{\hyperlink{timer_8h_a19aba4b4d8462e4f84b6eeabda21423c}{timer\_get\_count}}(\mbox{\hyperlink{timer__types_8h_a8bcc65cef9829505cbc2b3512bc017db}{hal\_timer\_t}}\ timer);}
\DoxyCodeLine{00096\ }
\DoxyCodeLine{00097\ \textcolor{comment}{//\ Timer\ Interrupt\ Management}}
\DoxyCodeLine{00098\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{timer_8h_a4ee300cb9e4b9356f445bbc7d0d7549f}{timer\_enable\_interrupt}}(\mbox{\hyperlink{timer__types_8h_a8bcc65cef9829505cbc2b3512bc017db}{hal\_timer\_t}}\ timer);}
\DoxyCodeLine{00099\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{timer_8h_a4784a158d5bf211d3f07cc83ca0b78c2}{timer\_disable\_interrupt}}(\mbox{\hyperlink{timer__types_8h_a8bcc65cef9829505cbc2b3512bc017db}{hal\_timer\_t}}\ timer);}
\DoxyCodeLine{00100\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{timer_8h_a6226a8f2f8b305c2a319ade05a77886c}{timer\_clear\_interrupt\_flag}}(\mbox{\hyperlink{timer__types_8h_a8bcc65cef9829505cbc2b3512bc017db}{hal\_timer\_t}}\ timer);}
\DoxyCodeLine{00101\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{timer_8h_a45f9a07b1ec73b7c758005623d8ab0e5}{timer\_attach\_callback}}(\mbox{\hyperlink{timer__types_8h_a8bcc65cef9829505cbc2b3512bc017db}{hal\_timer\_t}}\ timer,\ \textcolor{keywordtype}{void}\ (*callback)(\textcolor{keywordtype}{void}));}
\DoxyCodeLine{00102\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{timer_8h_a834d3bef7882671645ad5d3c58fa69bc}{timer\_detach\_callback}}(\mbox{\hyperlink{timer__types_8h_a8bcc65cef9829505cbc2b3512bc017db}{hal\_timer\_t}}\ timer);}
\DoxyCodeLine{00103\ }
\DoxyCodeLine{00104\ \textcolor{comment}{//\ Timer\ IRQ\ Handlers}}
\DoxyCodeLine{00105\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{timer_8h_a38ad4725462bdc5e86c4ead4f04b9fc2}{TIM2\_IRQHandler}}(\textcolor{keywordtype}{void});}
\DoxyCodeLine{00106\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{timer_8h_ac8e51d2183b5230cbd5481f8867adce9}{TIM3\_IRQHandler}}(\textcolor{keywordtype}{void});}
\DoxyCodeLine{00107\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{timer_8h_a7133f3f78767503641d307386e68bd28}{TIM4\_IRQHandler}}(\textcolor{keywordtype}{void});}
\DoxyCodeLine{00108\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{timer_8h_a5e66446caf21dd90191dc07a13ce2378}{TIM5\_IRQHandler}}(\textcolor{keywordtype}{void});}
\DoxyCodeLine{00109\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{timer_8h_a903756e157645ae9961b3e937c593c34}{TIM9\_IRQHandler}}(\textcolor{keywordtype}{void});}
\DoxyCodeLine{00110\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{timer_8h_aa6691f9947ff72bae0c9a47f5023cd39}{TIM12\_IRQHandler}}(\textcolor{keywordtype}{void});}
\DoxyCodeLine{00111\ }
\DoxyCodeLine{00112\ \textcolor{comment}{//\ PWM\ and\ Output\ Compare\ (Future\ Stage)}}
\DoxyCodeLine{00113\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{timer_8h_a3b5738efe72c1bd7130276a8f59b8234}{timer\_set\_compare}}(\mbox{\hyperlink{timer__types_8h_a8bcc65cef9829505cbc2b3512bc017db}{hal\_timer\_t}}\ timer,\ uint8\_t\ channel,}
\DoxyCodeLine{00114\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ uint32\_t\ compare\_value);}
\DoxyCodeLine{00115\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{timer_8h_a88f8507e6211bf708ff51187d308e00d}{timer\_enable\_pwm}}(\mbox{\hyperlink{timer__types_8h_a8bcc65cef9829505cbc2b3512bc017db}{hal\_timer\_t}}\ timer,\ uint8\_t\ channel);}
\DoxyCodeLine{00116\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{timer_8h_ad4f6dcd8d4cecddd113099a86df853e1}{timer\_disable\_pwm}}(\mbox{\hyperlink{timer__types_8h_a8bcc65cef9829505cbc2b3512bc017db}{hal\_timer\_t}}\ timer,\ uint8\_t\ channel);}
\DoxyCodeLine{00117\ }
\DoxyCodeLine{00118\ \textcolor{comment}{//\ Utility\ Functions}}
\DoxyCodeLine{00119\ uint32\_t\ \mbox{\hyperlink{timer_8h_a6b2fb6cbff774094130a964475db6b25}{timer\_get\_frequency}}(\mbox{\hyperlink{timer__types_8h_a8bcc65cef9829505cbc2b3512bc017db}{hal\_timer\_t}}\ timer);}
\DoxyCodeLine{00120\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{timer_8h_ad6a8de2e162397553b3421265987fb7b}{timer\_set\_prescaler}}(\mbox{\hyperlink{timer__types_8h_a8bcc65cef9829505cbc2b3512bc017db}{hal\_timer\_t}}\ timer,\ uint32\_t\ prescaler);}
\DoxyCodeLine{00121\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{timer_8h_a159fed92e0cdfaa14198b84dafe12f80}{timer\_set\_auto\_reload}}(\mbox{\hyperlink{timer__types_8h_a8bcc65cef9829505cbc2b3512bc017db}{hal\_timer\_t}}\ timer,\ uint32\_t\ arr);}
\DoxyCodeLine{00122\ }
\DoxyCodeLine{00123\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{//\ !CORTEX\_M4\_TIMER\_H}}

\end{DoxyCode}
